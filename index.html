<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØveApp – Januar 2026</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Inter', sans-serif; background:#f9fafb; margin:0; padding:12px;}
h1,h2 { text-align:center; margin-bottom:12px;}
button { cursor:pointer; }
#totalBar { position:fixed; bottom:0; left:0; right:0; background:#e5e7eb; overflow:hidden;}
#totalFill { background:linear-gradient(90deg,#4ade80,#22c55e); color:#064e3b; font-weight:700; padding:10px; width:0%; text-align:center; transition:0.3s;}
#calendar { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:14px; margin-bottom:60px;}
.day { background:white; border-radius:14px; padding:14px; box-shadow:0 6px 16px rgba(0,0,0,0.08);}
.day-title { font-weight:700; margin-bottom:6px;}
.day-note { font-size:13px; color:#6b7280; font-style:italic; margin-bottom:6px;}
.session { background:#e0e7ff; border:none; border-radius:10px; padding:8px; width:100%; text-align:left; margin-bottom:6px; font-weight:500;}
.session.done { background:#dcfce7; text-decoration:line-through; color:#065f46;}
select { width:100%; padding:6px; margin-top:4px; border-radius:6px;}
canvas { margin-top:24px; background:white; border-radius:14px; padding:14px;}
#menu { text-align:center; margin-bottom:12px;}
.menu-btn { margin:4px; padding:10px 14px; border-radius:10px; border:none; background:#3b82f6; color:white; font-weight:600;}
</style>
</head>
<body>

<h1>ØveApp</h1>
<div id="menu">
  <button class="menu-btn" onclick="startMonth('2026-01')">Januar 2026</button>
  <button class="menu-btn" onclick="showMaterials()">Øve materiale</button>
</div>

<div id="calendar" style="display:none;"></div>
<canvas id="progressChart" height="220" style="display:none;"></canvas>
<div id="totalBar" style="display:none;"><div id="totalFill">0 timer</div></div>

<script>
// ---------------- DATA ----------------
const instruments = ["Orgel","Trommer","Klaver"];
let materials = JSON.parse(localStorage.getItem("materials") || "{}");
let done = JSON.parse(localStorage.getItem("done") || "{}");
let currentMonth = "";

// JANUAR DATA (forkortet her, men du skal kopiere hele januar data)
const schedule = {
"2026-01-01":{note:"",sessions:[["7–8","Orgel"],["11–12","Trommer"],["11:30–12:30","Trommer"],["13–14","Klaver"]]},
"2026-01-02":{note:"",sessions:[["7–8","Orgel"],["9–10","Trommer"],["10:30–11:30","Trommer"],["12–13","Trommer"],["14–15","Klaver"]]},
// ... resten af januar
};

// ---------------- STATE ----------------
function save(){ localStorage.setItem("done",JSON.stringify(done)); localStorage.setItem("materials",JSON.stringify(materials)); }
function totalHours(){ return Object.values(done).filter(v=>v).length; }
function updateTotal(){
  const t = totalHours();
  const bar = document.getElementById("totalFill");
  bar.textContent = t + " timer";
  bar.style.width = Math.min(t*4,100)+"%";
}

// ---------------- UI ----------------
function startMonth(month){
  currentMonth=month;
  document.getElementById("calendar").style.display="grid";
  document.getElementById("progressChart").style.display="block";
  document.getElementById("totalBar").style.display="block";
  renderCalendar();
  updateChart();
}

function showMaterials(){
  alert("Øve materiale:\n"+JSON.stringify(materials,null,2));
}

function renderCalendar(){
  const cal = document.getElementById("calendar");
  cal.innerHTML="";
  Object.keys(schedule).forEach(date=>{
    const d = schedule[date];
    const box = document.createElement("div");
    box.className="day";
    box.innerHTML=`<div class="day-title">${date}</div>`;
    if(d.note) box.innerHTML+=`<div class="day-note">${d.note}</div>`;
    d.sessions.forEach((s,i)=>{
      const id = date+"-"+i;
      const b = document.createElement("div");
      b.className="session"+(done[id]?" done":"");
      b.textContent=`${s[0]} – ${s[1]}`;
      
      const sel = document.createElement("select");
      sel.style.display="none";
      sel.onchange = ()=>{
        if(sel.value==="") return;
        if(sel.value==="Slet"){
          delete done[id]; delete materials[id];
        } else {
          materials[id]=sel.value;
          done[id]=true;
        }
        sel.style.display="none";
        save(); renderCalendar(); updateTotal(); updateChart();
      };

      b.onclick=()=>{
        const prevMat = [...new Set(Object.values(materials).filter(m=>m && m!=="Orgel" && m!=="Trommer"))];
        sel.innerHTML = "<option value=''>Vælg materiale</option>";
        prevMat.forEach(m=>{ sel.innerHTML+=`<option value='${m}'>${m}</option>`; });
        sel.innerHTML += "<option value='Slet'>Slet</option>";
        sel.style.display="block";
      };

      box.appendChild(b);
      box.appendChild(sel);
    });
    cal.appendChild(box);
  });
  updateTotal();
}

// ---------------- CHART ----------------
let chart;
function updateChart(){
  const labels = Object.keys(schedule);
  const data = instruments.map(inst =>
    labels.map(d => schedule[d].sessions.filter((_,i)=>done[d+"-"+i] && schedule[d].sessions[i][1]===inst).length)
  );
  if(chart) chart.destroy();
  chart = new Chart(document.getElementById("progressChart"),{
    type:"line",
    data:{ labels, datasets:instruments.map((i,idx)=>({label:i,data:data[idx],tension:0.25}))},
    options:{scales:{y:{beginAtZero:true}}}
  });
}
</script>
</body>
</html>
